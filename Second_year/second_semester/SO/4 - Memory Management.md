# Introduction

What involves memory management?
- Program **loading** and their allocation in memory
- **Translation** of program logical addresses to physical addresses
- Manage presence of **more than one** program in memory and protect their memory spaces
- The ability to **load routines at runtime**
- **Sharing** memory space for several programs
- Execution of **programs that do not fit** in memory
- **Efficient management** of free memory space

# Basic concepts

## Memory hierarchy

![[Pasted image 20240229150938.png]]

## Independent logical spaces

- Program code always refers to program **logical address** between 0 and N
![[Pasted image 20240229151054.png]]
- The execution of a program accesses main memory **physical addresses**

Single-programming systems do not need any special treatment. *physical address=logical address*
In multiprogramming systems memory are shared by several processes. *physical address != logical address*. It's necessary to translate from logical addresses to physical addresses. This process is called **translation, relocation** or **correspondence**.

- **Relocation or correspondence:** Logical to physical address **translation**.
	- **Logical Addresses:** generated by the program
	- **Physical Addresses:** main memory addresses assigned to the process

- **BASIC translation function**
	- **Base register** (first position of the process physical space)
	- **Physical_addr = Logical_addr + base_register**

This translation can be done by hardware or by software

### Software relocation

Translation is done during program loading. In-memory program and executable are different. We don't need special hardware (MMU), but it's difficult to move the process memory space at runtime and we cannot provide complete memory protection
![[Pasted image 20240229152152.png]]

### Hardware translation

The **Memory Management Unit (MMU)** performs the translation by HW. OS is responsible for transfer data to HW for translation: transfer base register value to the MMU when there is a process switch
Translation done **at runtime by the MMU**
![[Pasted image 20240229152453.png]]

- **Monoprogramming**: Only the OS needs protection
- **Multiprogramming:** Processes have to  be protected from each other

It's necessary to validate **all addresses** generated by the program. The hardware does detection and the OS handle it. Basic HW mechanism:

```pseudocode
if address > process size
	then generate an Exception
else translate
```

# Memory Allocation Schemes

**Real Memory:**
- Memory is shared among all existing processes
- The whole process is loaded into memory while existing in the system

**Swapping:**
- To increase the number of processes into the system, processes can be swapped out to some disk area

**Virtual memory:**
- It allows to give processes more memory than the existing in the system
- It's not necessary to load the whole process into main memory to be executed

**Physical memory**
- Contiguous allocation
	- With fixed partitions
	- With variable partitions
- Non-contiguous allocation
	- Simple paging
	- Simple segmentation
	- Segmentation + simple paging

**Virtual memory**
- Paging
- Segmentation
- Segmentation + paging

The most used schema is the **Virtual memory** with paging

## Metrics

**Fragmentation:** % of memory that cannot be used.
- **Internal fragmentation:** Memory space assigned to a process that is not in use
- **External fragmentation:** Memory space that is not assigned to any process and it's not useful
- **Table fragmentation:** Memory space used by the OS to store the data structures needed to manage memory

# Physical memory

## Contiguous allocation

### Fixed partitions

Memory is divided into a **fixed number** or **fixed-size** partitions. The admin can configure the number of partitions and the size of each one, but it requires rebooting. Each process is assigned a free partition that fits, according to the *allocation policy* used by the OS.
The data structures 









>[!Important]
>Exam until Physical memory - Contiguous allocation - variable partitions
>
>Physical memory with non-contiguous allocation is not seen in this course (We jump directly to Virtual memory)
>
